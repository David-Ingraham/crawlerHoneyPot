<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Honeypot Traffic Analysis Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
</head>
<body>
    <nav>
        <div class="nav-content">
            <h1>Honeypot Traffic Analysis Dashboard</h1>
            <div class="nav-links">
                <a href="/" class="active">Dashboard</a>
                <a href="/about">About</a>
                <a href="/api/download-dataset" class="download-link" download>Download Dataset</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Introduction -->
        <div class="intro-section">
            <p>This dashboard monitors a honeypot, a deliberately exposed web server designed to attract automated scanners. Every day, thousands of automated programs scan the internet looking for vulnerable websites. This honeypot's domina, classified-mil.duckdns.org, acts as an observation point, recording every automated request it receives. By analyzing this data, we can see where these scanners come from, what vulnerabilities they're seeking, and identify common attack patterns. For more detail, visit my github repo at https://github.com/David-Ingraham/crawlerHoneyPot.</p>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="total-requests">--</div>
                <div class="stat-label">Total Requests</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="unique-ips">--</div>
                <div class="stat-label">Unique IPs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="today-count">--</div>
                <div class="stat-label">Last 24 Hours</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">
                    <span class="status-indicator"></span> Live
                </div>
                <div class="stat-label">Status</div>
            </div>
        </div>

        <!-- Threat Level Cards -->
        <div class="threat-grid">
            <div class="threat-card benign">
                <div class="threat-value" id="benign-count">--</div>
                <div class="threat-percent" id="benign-percent">--%</div>
                <div class="threat-label">Benign Traffic</div>
            </div>
            <div class="threat-card reconnaissance">
                <div class="threat-value" id="reconnaissance-count">--</div>
                <div class="threat-percent" id="reconnaissance-percent">--%</div>
                <div class="threat-label">Reconnaissance</div>
            </div>
            <div class="threat-card malicious">
                <div class="threat-value" id="malicious-count">--</div>
                <div class="threat-percent" id="malicious-percent">--%</div>
                <div class="threat-label">Malicious</div>
            </div>
        </div>

        <!-- Charts Row 1 -->
        <div class="chart-grid">
            <div class="chart-card">
                <h2>Traffic Categories</h2>
                <canvas id="categoriesChart"></canvas>
            </div>
            <div class="chart-card">
                <h2>Targeted Vulnerability Scans</h2>
                <canvas id="attackTypesChart"></canvas>
            </div>
        </div>

        <!-- Charts Row 2 -->
        <div class="chart-grid">
            <div class="chart-card">
                <h2>Top 10 Source IPs by Request Volume</h2>
                <canvas id="topIpsChart"></canvas>
            </div>
            <div class="chart-card">
                <h2>Most Requested Paths</h2>
                <canvas id="topPathsChart"></canvas>
            </div>
        </div>

        <!-- Timeline Chart (Full Width) -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h2>Request Timeline</h2>
                <div class="timeline-controls">
                    <button class="timeline-btn active" data-days="7">Week</button>
                    <button class="timeline-btn" data-days="14">2 Weeks</button>
                    <button class="timeline-btn" data-days="30">Month</button>
                    <button class="timeline-btn" data-days="0">All Time</button>
                </div>
            </div>
            <canvas id="timelineChart"></canvas>
        </div>

        <!-- Geographic Distribution Map -->
        <div class="chart-card full-width">
            <h2>Geographic Distribution of Traffic</h2>
            <div id="attack-map"></div>
        </div>

        <!-- Recent Requests Table -->
        <div class="table-card">
            <h2>Recent Requests</h2>
            <div class="table-container">
                <table id="recent-attacks">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>IP Address</th>
                            <th>Target Path</th>
                            <th>User Agent</th>
                            <th>Category</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td colspan="5" class="loading">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <footer>
        <p>Data collected from internet honeypot | Updates every 30 seconds | 
        <a href="/about">Learn more about this project</a></p>
    </footer>

    <!-- Request Details Modal -->
    <div id="threat-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Request Details</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-loading" class="modal-loading">Loading requests...</div>
                <div id="modal-requests" class="request-list"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
</body>
</html>


